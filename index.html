<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="linfa,ml,stats,statistical learning, machine learning,rust">
  <meta name="description" content="comprehensive toolkit for statistical learning in rust">
  <title>Linfa Toolkit</title>

  <link rel="icon" href="mascot.svg">
  <link rel="stylesheet" href="https://rust-ml.github.io/linfa/style.css">
  <script src="https://rust-ml.github.io/linfa/code-examples.js"></script>
</head>

<body>
  <div class="top">
      <section class="grid header">
          <div class="logo">
              <img alt="logo" src="https://rust-ml.github.io/linfa/mascot.svg" height=60>
            <p>
                Linfa
                
                <span>Menu</span>
            </p>
          </div>
          <div class="header-main">
              <ul>
                  <li><a href="https://rust-ml.github.io/linfa">Home</a></li>
                  <li><a href="https://rust-ml.github.io/linfa/about">About</a></li>
                  <li><a href="https://rust-ml.github.io/linfa/docs">Documentation</a></li>
                  <li><a href="https://rust-ml.github.io/linfa/community">Community</a></li>
                  <li><a href="https://rust-ml.github.io/linfa/news">News</a></li>
              </ul>
          </div>
      </section>
  </div>


  <section class="section">
    <div class="container">
      
<div class="expose"><div class="grid">
<div class="introduction">
    <h1>A comprehensive toolkit for Statistical Learning in Rust.</h1>
    <p>
    Linfa is a comprehensive toolkit for statistical learning, providing algorithms for optimal model and density estimation.
    </p>
    <p>
    It contains common learning algorithms such as Elastic Net, Support Vector Machines, Kernel Methods, Linear Decision Trees, etc. and bundles them together.
    </p>
    <p>
    You can find the source code at <a href="https://github.com/rust-ml/linfa">rust-ml/linfa</a>.
   </p>
</div>
<div class="code-examples">
    <select title="Choose a code example to display">
        
        
        
            <option data-example="Barnes-Hut t-SNE" selected="selected">
        

            Barnes-Hut t-SNE
        </option>
        
        
            <option data-example="Linear Decision Trees">
        

            Linear Decision Trees
        </option>
        
        
            <option data-example="Gaussian Naive Bayes">
        

            Gaussian Naive Bayes
        </option>
        
        
            <option data-example="Support Vector Machines">
        

            Support Vector Machines
        </option>
        
        
            <option data-example="Multi Targets">
        

            Multi Targets
        </option>
        
        
            <option data-example="Diffusion Maps">
        

            Diffusion Maps
        </option>
        
        
            <option data-example="Elastic Net">
        

            Elastic Net
        </option>
        
        
            <option data-example="Multi Class">
        

            Multi Class
        </option>
        
        
            <option data-example="K folding">
        

            K folding
        </option>
        
        
            <option data-example="Cross Validation">
        

            Cross Validation
        </option>
        
        
            <option data-example="Partial least squares regression">
        

            Partial least squares regression
        </option>
        
        
            <option data-example="Gaussian Random Projection">
        

            Gaussian Random Projection
        </option>
        
    </select>
        
        
            <div class="example visible" data-example="Barnes-Hut t-SNE">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// normalize the iris dataset
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> ds </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>linfa_datasets::iris();
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> ds </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>Pca::params(</span><span style="color:#0086b3;">3</span><span>).</span><span style="color:#62a35c;">whiten</span><span>(</span><span style="color:#0086b3;">true</span><span>).</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>ds).</span><span style="color:#62a35c;">transform</span><span>(ds);
</span><span>
</span><span style="font-style:italic;color:#969896;">// transform to two-dimensional embeddings
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> ds </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>TSne::embedding_size(</span><span style="color:#0086b3;">2</span><span>)
</span><span>    .</span><span style="color:#62a35c;">perplexity</span><span>(</span><span style="color:#0086b3;">10.0</span><span>)
</span><span>    .</span><span style="color:#62a35c;">approx_threshold</span><span>(</span><span style="color:#0086b3;">0.1</span><span>)
</span><span>    .</span><span style="color:#62a35c;">transform</span><span>(ds)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// write embedding to file
</span><span style="font-weight:bold;color:#a71d5d;">let mut</span><span> f </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>File::create(</span><span style="color:#183691;">&quot;iris.dat&quot;</span><span>)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span style="font-weight:bold;color:#a71d5d;">for </span><span>(x, y) </span><span style="font-weight:bold;color:#a71d5d;">in</span><span> ds.</span><span style="color:#62a35c;">sample_iter</span><span>() {
</span><span>    f.</span><span style="color:#62a35c;">write</span><span>(format!(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">{} {} {}\n</span><span style="color:#183691;">&quot;</span><span>, x[</span><span style="color:#0086b3;">0</span><span>], x[</span><span style="color:#0086b3;">1</span><span>], y[</span><span style="color:#0086b3;">0</span><span>]).</span><span style="color:#62a35c;">as_bytes</span><span>())</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>}
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Linear Decision Trees">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-weight:bold;color:#a71d5d;">let </span><span>(train, valid) </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>linfa_datasets::iris()
</span><span>    .</span><span style="color:#62a35c;">split_with_ratio</span><span>(</span><span style="color:#0086b3;">0.8</span><span>);
</span><span>
</span><span style="font-style:italic;color:#969896;">// Train model with Gini criterion
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> gini_model </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>DecisionTree::params()
</span><span>    .</span><span style="color:#62a35c;">split_quality</span><span>(SplitQuality::Gini)
</span><span>    .</span><span style="color:#62a35c;">max_depth</span><span>(</span><span style="color:#0086b3;">Some</span><span>(</span><span style="color:#0086b3;">100</span><span>))
</span><span>    .</span><span style="color:#62a35c;">min_weight_split</span><span>(</span><span style="color:#0086b3;">1.0</span><span>)
</span><span>    .</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>train)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> cm </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> gini_model.</span><span style="color:#62a35c;">predict</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid)
</span><span>    .</span><span style="color:#62a35c;">confusion_matrix</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid);
</span><span>
</span><span>println!(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">{:?}</span><span style="color:#183691;">&quot;</span><span>, cm);
</span><span>println!(</span><span style="color:#183691;">&quot;Accuracy </span><span style="color:#0086b3;">{}</span><span style="color:#183691;">%&quot;</span><span>, cm.</span><span style="color:#62a35c;">accuracy</span><span>() </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">100.0</span><span>);
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Gaussian Naive Bayes">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-weight:bold;color:#a71d5d;">let </span><span>(train, valid) </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>linfa_datasets::iris()
</span><span>    .</span><span style="color:#62a35c;">split_with_ratio</span><span>(</span><span style="color:#0086b3;">0.8</span><span>);
</span><span>
</span><span style="font-style:italic;color:#969896;">// train the model
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> model </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>GaussianNbParams::params()
</span><span>    .</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>train)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// Predict the validation dataset
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> pred </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> model.</span><span style="color:#62a35c;">predict</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid);
</span><span>
</span><span style="font-style:italic;color:#969896;">// construct confusion matrix
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> cm </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> pred.</span><span style="color:#62a35c;">confusion_matrix</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// print confusion matrix, accuracy and precision
</span><span>println!(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">{:?}</span><span style="color:#183691;">&quot;</span><span>, cm);
</span><span>println!(</span><span style="color:#183691;">&quot;accuracy </span><span style="color:#0086b3;">{}</span><span style="color:#183691;">, precision </span><span style="color:#0086b3;">{}</span><span style="color:#183691;">&quot;</span><span>, 
</span><span>    cm.</span><span style="color:#62a35c;">accuracy</span><span>(), cm.</span><span style="color:#62a35c;">precision</span><span>());
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Support Vector Machines">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// everything above 6.5 is considered a good wine
</span><span style="font-weight:bold;color:#a71d5d;">let </span><span>(train, valid) </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>linfa_datasets::winequality()
</span><span>    .</span><span style="color:#62a35c;">map_targets</span><span>(|x| </span><span style="font-weight:bold;color:#a71d5d;">*</span><span>x </span><span style="font-weight:bold;color:#a71d5d;">&gt; </span><span style="color:#0086b3;">6</span><span>)
</span><span>    .</span><span style="color:#62a35c;">split_with_ratio</span><span>(</span><span style="color:#0086b3;">0.9</span><span>);
</span><span>
</span><span style="font-style:italic;color:#969896;">// train SVM with nu=0.01 and RBF with eps=80.0
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> model </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>Svm::params()
</span><span>    .</span><span style="color:#62a35c;">nu_weight</span><span>(</span><span style="color:#0086b3;">0.01</span><span>)
</span><span>    .</span><span style="color:#62a35c;">gaussian_kernel</span><span>(</span><span style="color:#0086b3;">80.0</span><span>)
</span><span>    .</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>train)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// print model performance and number of SVs
</span><span>println!(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">{}</span><span style="color:#183691;">&quot;</span><span>, model);
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Multi Targets">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// assume we have a dataset with multiple,
</span><span style="font-style:italic;color:#969896;">// uncorrelated targets and we want to train
</span><span style="font-style:italic;color:#969896;">// a single model for each target variable
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> model </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> train.</span><span style="color:#62a35c;">target_iter</span><span>()
</span><span>    .</span><span style="color:#62a35c;">map</span><span>(|x| params.</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>x).</span><span style="color:#62a35c;">unwrap</span><span>())
</span><span>    .collect::&lt;MultiTarget&lt;</span><span style="font-weight:bold;color:#a71d5d;">_</span><span>, </span><span style="font-weight:bold;color:#a71d5d;">_</span><span>&gt;&gt;()</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// composing `model` returns multiple targets
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> valid_est </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> model.</span><span style="color:#62a35c;">predict</span><span>(valid);
</span><span>println!(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">{}</span><span style="color:#183691;">&quot;</span><span>, valid_est.</span><span style="color:#62a35c;">ntargets</span><span>());
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Diffusion Maps">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// generate RBF kernel with sparsity constraints
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> kernel </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>Kernel::params()
</span><span>    .</span><span style="color:#62a35c;">kind</span><span>(KernelType::Sparse(</span><span style="color:#0086b3;">15</span><span>))
</span><span>    .</span><span style="color:#62a35c;">method</span><span>(KernelMethod::Gaussian(</span><span style="color:#0086b3;">2.0</span><span>))
</span><span>    .</span><span style="color:#62a35c;">transform</span><span>(dataset.</span><span style="color:#62a35c;">view</span><span>());
</span><span>
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> embedding </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>DiffusionMap::&lt;</span><span style="font-weight:bold;color:#a71d5d;">f64</span><span>&gt;::params(</span><span style="color:#0086b3;">2</span><span>)
</span><span>    .</span><span style="color:#62a35c;">steps</span><span>(</span><span style="color:#0086b3;">1</span><span>)
</span><span>    .</span><span style="color:#62a35c;">transform</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>kernel)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// get embedding
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> embedding </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> embedding.</span><span style="color:#62a35c;">embedding</span><span>();
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Elastic Net">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-weight:bold;color:#a71d5d;">let </span><span>(train, valid) </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>linfa_datasets::diabetes()
</span><span>    .</span><span style="color:#62a35c;">split_with_ratio</span><span>(</span><span style="color:#0086b3;">0.9</span><span>);
</span><span>
</span><span style="font-style:italic;color:#969896;">// train pure LASSO model with 0.1 penalty
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> model </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>ElasticNet::params()
</span><span>    .</span><span style="color:#62a35c;">penalty</span><span>(</span><span style="color:#0086b3;">0.1</span><span>)
</span><span>    .</span><span style="color:#62a35c;">l1_ratio</span><span>(</span><span style="color:#0086b3;">1.0</span><span>)
</span><span>    .</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>train)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span>println!(</span><span style="color:#183691;">&quot;z score: </span><span style="color:#0086b3;">{:?}</span><span style="color:#183691;">&quot;</span><span>, model.</span><span style="color:#62a35c;">z_score</span><span>());
</span><span>
</span><span style="font-style:italic;color:#969896;">// validate
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> y_est </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> model.</span><span style="color:#62a35c;">predict</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid);
</span><span>println!(</span><span style="color:#183691;">&quot;predicted variance: </span><span style="color:#0086b3;">{}</span><span style="color:#183691;">&quot;</span><span>, y_est.</span><span style="color:#62a35c;">r2</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>);
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Multi Class">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-weight:bold;color:#a71d5d;">let</span><span> params </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>Svm::&lt;</span><span style="font-weight:bold;color:#a71d5d;">_</span><span>, Pr&gt;::params()
</span><span>    .</span><span style="color:#62a35c;">gaussian_kernel</span><span>(</span><span style="color:#0086b3;">30.0</span><span>);
</span><span>
</span><span style="font-style:italic;color:#969896;">// assume we have a binary decision model (here SVM) 
</span><span style="font-style:italic;color:#969896;">// predicting probability. We can merge them into a 
</span><span style="font-style:italic;color:#969896;">// multi-class model by collecting several of them
</span><span style="font-style:italic;color:#969896;">// into a `MultiClassModel`
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> model </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> train
</span><span>    .</span><span style="color:#62a35c;">one_vs_all</span><span>()</span><span style="font-weight:bold;color:#a71d5d;">?
</span><span>    .</span><span style="color:#62a35c;">into_iter</span><span>()
</span><span>    .</span><span style="color:#62a35c;">map</span><span>(|(l, x)| (l, params.</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>x).</span><span style="color:#62a35c;">unwrap</span><span>()))
</span><span>    .collect::&lt;MultiClassModel&lt;</span><span style="font-weight:bold;color:#a71d5d;">_</span><span>, </span><span style="font-weight:bold;color:#a71d5d;">_</span><span>&gt;&gt;();
</span><span>
</span><span style="font-style:italic;color:#969896;">// predict multi-class label
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> pred </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> model.</span><span style="color:#62a35c;">predict</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid);
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="K folding">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// perform cross-validation with the F1 score
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> f1_runs </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> dataset
</span><span>    .</span><span style="color:#62a35c;">iter_fold</span><span>(</span><span style="color:#0086b3;">8</span><span>, |v| params.</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>v).</span><span style="color:#62a35c;">unwrap</span><span>())
</span><span>    .</span><span style="color:#62a35c;">map</span><span>(|(model, valid)| {
</span><span>        </span><span style="font-weight:bold;color:#a71d5d;">let</span><span> cm </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> model
</span><span>            .</span><span style="color:#62a35c;">predict</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid)
</span><span>            .</span><span style="color:#62a35c;">mapv</span><span>(|x| x </span><span style="font-weight:bold;color:#a71d5d;">&gt; </span><span>Pr::even())
</span><span>            .</span><span style="color:#62a35c;">confusion_matrix</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>valid).</span><span style="color:#62a35c;">unwrap</span><span>();
</span><span>  
</span><span>          cm.</span><span style="color:#62a35c;">f1_score</span><span>()
</span><span>    })  
</span><span>    .collect::&lt;Array1&lt;</span><span style="font-weight:bold;color:#a71d5d;">_</span><span>&gt;&gt;();
</span><span>  
</span><span style="font-style:italic;color:#969896;">// calculate mean and standard deviation
</span><span>println!(</span><span style="color:#183691;">&quot;F1 score: </span><span style="color:#0086b3;">{}</span><span style="color:#183691;">±</span><span style="color:#0086b3;">{}</span><span style="color:#183691;">&quot;</span><span>,
</span><span>    f1_runs.</span><span style="color:#62a35c;">mean</span><span>().</span><span style="color:#62a35c;">unwrap</span><span>(),
</span><span>    f1_runs.</span><span style="color:#62a35c;">std_axis</span><span>(Axis(</span><span style="color:#0086b3;">0</span><span>), </span><span style="color:#0086b3;">0.0</span><span>),
</span><span>);  
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Cross Validation">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// parameters to compare
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> ratios </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>vec![</span><span style="color:#0086b3;">0.1</span><span>, </span><span style="color:#0086b3;">0.2</span><span>, </span><span style="color:#0086b3;">0.5</span><span>, </span><span style="color:#0086b3;">0.7</span><span>, </span><span style="color:#0086b3;">1.0</span><span>];
</span><span>
</span><span style="font-style:italic;color:#969896;">// create a model for each parameter
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> models </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> ratios
</span><span>    .</span><span style="color:#62a35c;">iter</span><span>()
</span><span>    .</span><span style="color:#62a35c;">map</span><span>(|ratio| ElasticNet::params().</span><span style="color:#62a35c;">penalty</span><span>(</span><span style="color:#0086b3;">0.3</span><span>).</span><span style="color:#62a35c;">l1_ratio</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">*</span><span>ratio))
</span><span>    .collect::&lt;</span><span style="color:#0086b3;">Vec</span><span>&lt;</span><span style="font-weight:bold;color:#a71d5d;">_</span><span>&gt;&gt;();
</span><span>
</span><span style="font-style:italic;color:#969896;">// get the mean r2 validation score across 5 folds for each model
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> r2_values </span><span style="font-weight:bold;color:#a71d5d;">=
</span><span>    dataset.</span><span style="color:#62a35c;">cross_validate</span><span>(</span><span style="color:#0086b3;">5</span><span>, </span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>models, |prediction, truth| prediction.</span><span style="color:#62a35c;">r2</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>truth))</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// show the mean r2 score for each parameter choice
</span><span style="font-weight:bold;color:#a71d5d;">for </span><span>(ratio, r2) </span><span style="font-weight:bold;color:#a71d5d;">in</span><span> ratios.</span><span style="color:#62a35c;">iter</span><span>().</span><span style="color:#62a35c;">zip</span><span>(r2_values.</span><span style="color:#62a35c;">iter</span><span>()) {
</span><span>    println!(</span><span style="color:#183691;">&quot;L1 ratio: </span><span style="color:#0086b3;">{}</span><span style="color:#183691;">, r2 score: </span><span style="color:#0086b3;">{}</span><span style="color:#183691;">&quot;</span><span>, ratio, r2);
</span><span>}
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Partial least squares regression">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// Load linnerud dataset with  20 samples, 
</span><span style="font-style:italic;color:#969896;">// 3 input features, 3 output features
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> ds </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>linfa_datasets::linnerud();
</span><span>
</span><span style="font-style:italic;color:#969896;">// Fit PLS2 method using 2 principal components 
</span><span style="font-style:italic;color:#969896;">// (latent variables)
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> pls </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>PlsRegression::params(</span><span style="color:#0086b3;">2</span><span>).</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>ds)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span>
</span><span style="font-style:italic;color:#969896;">// We can either apply the dimension reduction to the dataset
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> reduced_ds </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> pls.</span><span style="color:#62a35c;">transform</span><span>(ds);
</span><span>
</span><span style="font-style:italic;color:#969896;">// ... or predict outputs given a new input sample.
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> exercices </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>array![[</span><span style="color:#0086b3;">14.</span><span>, </span><span style="color:#0086b3;">146.</span><span>, </span><span style="color:#0086b3;">61.</span><span>], [</span><span style="color:#0086b3;">6.</span><span>, </span><span style="color:#0086b3;">80.</span><span>, </span><span style="color:#0086b3;">60.</span><span>]];
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> physio_measures </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> pls.</span><span style="color:#62a35c;">predict</span><span>(exercices);
</span></code></pre>

        </div>
        
        
            <div class="example" data-example="Gaussian Random Projection">
        
            <pre data-lang="rust" style="background-color:#ffffff;color:#323232;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#969896;">// Assume we get some training data like MNIST: 60000 samples of 28*28 images (ie dim 784)
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> dataset </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>Dataset::from(Array::&lt;</span><span style="font-weight:bold;color:#a71d5d;">f64</span><span>, </span><span style="font-weight:bold;color:#a71d5d;">_</span><span>&gt;::random((</span><span style="color:#0086b3;">60000</span><span>, </span><span style="color:#0086b3;">28 </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">28</span><span>), Standard));
</span><span>
</span><span style="font-style:italic;color:#969896;">// We can work in a reduced dimension using a Gaussian Random Projection
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> reduced_dim </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">100</span><span>;
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> proj </span><span style="font-weight:bold;color:#a71d5d;">= </span><span>GaussianRandomProjection::&lt;</span><span style="font-weight:bold;color:#a71d5d;">f32</span><span>&gt;::params()
</span><span>    .</span><span style="color:#62a35c;">target_dim</span><span>(reduced_dim)
</span><span>    .</span><span style="color:#62a35c;">fit</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>dataset)</span><span style="font-weight:bold;color:#a71d5d;">?</span><span>;
</span><span style="font-weight:bold;color:#a71d5d;">let</span><span> reduced_ds </span><span style="font-weight:bold;color:#a71d5d;">=</span><span> proj.</span><span style="color:#62a35c;">transform</span><span>(</span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span>dataset);
</span><span>
</span><span>println!(</span><span style="color:#183691;">&quot;New dataset shape: </span><span style="color:#0086b3;">{:?}</span><span style="color:#183691;">&quot;</span><span>, reduced_ds.</span><span style="color:#62a35c;">records</span><span>().</span><span style="color:#62a35c;">shape</span><span>());
</span><span style="font-style:italic;color:#969896;">// -&gt; New dataset shape: [60000, 100]
</span></code></pre>

        </div>
        
</div>
</div></div>
<div class="highlights">
<div class="colored"><div class="grid">
    <section>
        <h2>Fast by default</h2>
        <p>The Rust language allows us to implement everything directly without the need to trade performance for readability.</p>
        <p>No need to have a second language for performance reason.</p>
    </section>
    <section>
        <h2>Embedded in the Rust ecosystem</h2>
        <p>We use many existing tools from the Rust ecosystem to improve the code quality.</p>
        <p>We are using <a href="https://github.com/rust-lang/rustfmt">rustfmt</a>, <a href="https://github.com/rust-lang/rust-clippy">clippy</a>, <a href="https://github.com/xd009642/tarpaulin">Tarpaulin</a>, Github Actions and <a href="https://docs.rs/approx/0.4.0/approx/">approx</a> for testing and verification.</p>
    </section>
    <section>
        <h2>Reason more clearly</h2>
        <p>Benefit from a clear ownership  model and structure your code flow with functional programming.</p>
        <p>Many composing algorithms can be expressed more clearly with features missing in older imperative languages.</p>
    </section>
</div></div>
<div class="not-colored"><div class="grid">
    <section>
        <h2>Published by <a href="https://github.com/rust-ml">rust-ml</a> group</h2>
        <p>We are a group of ML/stats people who are exploring the language space for more performant and readable implementations.</p>
    </section>
    <section>
        <h2>Beginner friendly</h2>
        <p>No need to be an expert or have years of programming experience.</p>
        <p>If you are interest in a specific implementation or need some inspiration to learn Rust for data processing reach out to us. We are happy to help on both sides.</p>
    </section>
    <section>
        <h2>FOSS and accessible</h2>
        <p>Everything is published under the Apache/MIT license and we are trying constantly to make the code as accessible as possible for humans and machines.</p>
        <p>The development of Linfa happens in public and every contribution is welcome.</p>
    </section>
    </div></div>
<div class="colored"><div class="grid">
    <section>
        <h2>Clustering</h2>
        <p>Typical implementations for clustering algorithms, such as K-Means, Gaussian Mixture and DBSCAN.</p>
    </section>
    <section>
        <h2>Dimensionality reduction</h2>
        <p>Variance preserving algorithms with linear (PCA) and non-linear (Diffusion Maps) implementations.</p>
        <p>The implementation uses LOBPCG and can handle high-dimensional data very efficiently.</p>
    </section>
    <section>
        <h2>Target modeling</h2>
        <p>Regression with shrinkage operators, such as LASSO and Ridge.</p>
        <p>Classification of linear, as well as non-linear data with SVM and kernel-methods.</p>
        <p>There are many more implementations, which you can find <a href="https://github.com/rust-ml/linfa#current-state">here</a>.</p>
    </section>
</div></div>
</div>

    </div>
  </section>
  <div class="bottom"><div class="grid">
      <div class="footer">View
          <a href="https://github.com/rust-ml/linfa/tree/master/docs/website">page source</a>
          - any contribution is welcome!
      </div>
  </div></div>
</body>
</html>
